---
// Importiamo il nostro "Cervello" (il file JSON)
import siteData from '../data.json';

// Estraiamo i blocchi che ci servono per comodità
const { impostazioni_sito, seo_manager, tema_grafico, navigazione_menu, orari_apertura } = siteData;
---

<html lang={impostazioni_sito.lingua_default || 'it'} class="scroll-smooth">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    
    <title>{seo_manager.meta_titolo}</title>
    <meta name="description" content={seo_manager.meta_descrizione} />
    <meta name="keywords" content={seo_manager.parole_chiave} />
    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;700&family=Playfair+Display:ital,wght@0,400;0,700;1,400&display=swap" rel="stylesheet">
    
    <style define:vars={{
      colorPrimario: tema_grafico.colore_primario,
      colorSecondario: tema_grafico.colore_secondario,
      colorSfondo: tema_grafico.colore_sfondo,
      colorCard: tema_grafico.colore_card
    }}>
      :root {
        --colorNocciola: var(--colorPrimario); 
        --colorRosso: var(--colorSecondario);    
      }
      body {
        background-color: var(--colorSfondo);
        color: white;
        font-family: 'Inter', sans-serif;
        overflow-x: hidden;
      }
      .bg-card { background-color: var(--colorCard); }
      .bg-sfondo { background-color: var(--colorSfondo); }
      .font-elegante {
        font-family: 'Playfair Display', serif;
      }
      
      .reveal {
        opacity: 0;
        transform: translateY(30px);
        transition: all 0.8s ease-out;
      }
      .reveal.active {
        opacity: 1;
        transform: translateY(0);
      }
      
      #mobile-menu {
        transition: transform 0.4s ease-in-out;
        transform: translateY(-100%);
      }
      #mobile-menu.open {
        transform: translateY(0);
      }
    </style>
  </head>
  <body class="antialiased flex flex-col min-h-screen">
    
    <nav class="fixed w-full z-50 bg-sfondo/95 backdrop-blur-md border-b border-white/10 transition-all duration-300" id="navbar">
      <div class="max-w-7xl mx-auto px-4 lg:px-8">
        <div class="flex justify-between items-center h-20">
          
          <a href="/" class="text-[var(--colorNocciola)] text-xl md:text-2xl font-elegante tracking-widest uppercase font-bold drop-shadow-md z-50 relative">
            {impostazioni_sito.nome_brand}
          </a>
          
          <div class="hidden md:flex space-x-8 text-xs font-bold tracking-widest uppercase text-gray-300">
            {navigazione_menu.map((item) => (
              <a href={item.url} class="hover:text-[var(--colorNocciola)] transition-colors">{item.etichetta}</a>
            ))}
          </div>

          <button id="hamburger-btn" class="md:hidden text-[var(--colorNocciola)] z-50 relative p-2 focus:outline-none" aria-label="Menu">
            <svg class="w-8 h-8" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path id="hamburger-icon" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path>
            </svg>
          </button>

        </div>
      </div>
    </nav>

    <div id="mobile-menu" class="fixed inset-0 bg-sfondo z-40 flex flex-col items-center justify-center pt-20 h-screen md:hidden">
        <div class="flex flex-col space-y-8 text-center text-lg font-bold tracking-widest uppercase text-gray-300">
            {navigazione_menu.map((item) => (
              <a href={item.url} class="mobile-link hover:text-[var(--colorNocciola)] transition-colors">{item.etichetta}</a>
            ))}
        </div>
    </div>

    <main class="flex-grow pt-0">
      <slot />
    </main>

    <footer class="bg-card py-16 border-t border-white/5 text-center relative z-10">
      <div class="max-w-4xl mx-auto px-4">
        <h2 class="text-3xl text-[var(--colorNocciola)] font-elegante uppercase tracking-widest mb-4">{impostazioni_sito.nome_brand}</h2>
        <p class="text-gray-500 text-xs md:text-sm mb-8 tracking-widest uppercase font-light">{impostazioni_sito.sottotitolo_brand}</p>
        
        <div class="mb-12 border border-white/5 p-6 inline-block rounded-sm bg-black/20">
          <h3 class="text-white text-xs font-bold tracking-widest uppercase mb-4">{orari_apertura.titolo_sezione}</h3>
          <ul class="text-gray-400 text-xs font-light tracking-wider space-y-2">
            <li><span class="text-white">Lunedì:</span> {orari_apertura.lunedi}</li>
            <li><span class="text-white">Mar-Gio:</span> {orari_apertura.martedi}</li>
            <li><span class="text-white">Ven-Sab:</span> {orari_apertura.venerdi}</li>
            <li><span class="text-white">Domenica:</span> {orari_apertura.domenica}</li>
          </ul>
        </div>

        <div class="flex flex-wrap justify-center gap-6 text-xs uppercase tracking-widest text-gray-400 mb-12">
            {navigazione_menu.map((item) => (
              <a href={item.url} class="hover:text-white transition-colors">{item.etichetta}</a>
            ))}
        </div>
        
        <p class="text-[10px] text-gray-600 tracking-widest uppercase">
          &copy; {new Date().getFullYear()} {impostazioni_sito.nome_brand}. Tutti i diritti riservati. <br/>
          {impostazioni_sito.telefono_principale ? `Info: +${impostazioni_sito.telefono_principale}` : ''}
        </p>
      </div>
    </footer>

    <script is:inline>
      function reveal() {
        var reveals = document.querySelectorAll(".reveal");
        for (var i = 0; i < reveals.length; i++) {
          var windowHeight = window.innerHeight;
          var elementTop = reveals[i].getBoundingClientRect().top;
          var elementVisible = 100;
          if (elementTop < windowHeight - elementVisible) {
            reveals[i].classList.add("active");
          }
        }
      }
      window.addEventListener("scroll", reveal);
      reveal();

      document.addEventListener('DOMContentLoaded', () => {
        const btn = document.getElementById('hamburger-btn');
        const menu = document.getElementById('mobile-menu');
        const icon = document.getElementById('hamburger-icon');
        const links = document.querySelectorAll('.mobile-link');

        if (btn && menu && icon) {
          function toggleMenu() {
            menu.classList.toggle('open');
            if (menu.classList.contains('open')) {
              icon.setAttribute('d', 'M6 18L18 6M6 6l12 12'); 
              document.body.style.overflow = 'hidden'; 
            } else {
              icon.setAttribute('d', 'M4 6h16M4 12h16M4 18h16'); 
              document.body.style.overflow = ''; 
            }
          }

          btn.addEventListener('click', toggleMenu);
          links.forEach(link => link.addEventListener('click', toggleMenu));
        }
      });
    </script>
  </body>
</html>